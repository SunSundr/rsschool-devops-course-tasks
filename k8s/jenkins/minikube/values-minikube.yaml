controller:
  admin:
    existingSecret: "jenkins-admin-secret"
    userKey: "username"
    passwordKey: "password"
  
  # Master doesn't run builds - agents do
  numExecutors: 0
  executorMode: "NORMAL"
  
  resources:
    requests:
      cpu: "50m"
      memory: "256Mi"
    limits:
      cpu: "2000m"
      memory: "4096Mi"
  
  persistence:
    enabled: true
    existingClaim: "jenkins-pvc"
  
  serviceType: NodePort
  nodePort: 32000
  
  # Agent listener service
  agentListenerEnabled: true
  agentListenerPort: 50000
  agentListenerServiceType: "ClusterIP"
  
  serviceAccount:
    create: true

  installPlugins:
    - kubernetes:4203.v1dd44f5b_1cf9
    - workflow-aggregator:608.v67378e9d3db_1
    - git:5.7.0
    - configuration-as-code:1971.vf9280461ea_89
    - credentials:1415.v831096eb_5534
    - job-dsl:1.93
    - structs:350.v3b_30f09f2363
    - script-security:1373.vb_b_4a_a_c26fa_00
    - eddsa-api:0.3.0.1-19.vc432d923e5ee
  
  # Prevent plugin updates that cause compatibility issues
  installLatestPlugins: false
  installLatestSpecifiedPlugins: false
  overwritePlugins: true
  
  JCasC:
    defaultConfig: true
    overwriteConfiguration: false
    configUrls: []
    configScripts:
      hello-job: |
        jobs:
          - script: >
              job('hello-world') {
                description('Simple Hello World job created via JCasC')
                steps {
                  shell('echo "Hello World from Jenkins!"')
                  shell('echo "Current date: $(date)"')
                  shell('echo "Jenkins JCasC is working!"')
                  shell('echo "Job completed successfully!"')
                }
              }
    
    # Security configuration
    security:
      apiToken:
        creationOfLegacyTokenEnabled: false
        tokenGenerationOnCreationEnabled: false
        usageStatisticsEnabled: true
    
    securityRealm: |
      local:
        allowsSignup: false
        enableCaptcha: false
        users:
        - id: "${chart-admin-username}"
          name: "Jenkins Admin"
          password: "${chart-admin-password}"
    
    authorizationStrategy: |
      loggedInUsersCanDoAnything:
        allowAnonymousRead: false

# Enable agents for builds
agent:
  enabled: true
  
  serviceAccount:
    create: false
    name: jenkins
  
  resources:
    requests:
      cpu: "512m"
      memory: "512Mi"
    limits:
      cpu: "512m"
      memory: "512Mi"
  
  # Agent configuration
  containerCap: 10
  instanceCap: 2147483647
  podRetention: "OnFailure"  # Keep successful pods for debugging
  showRawYaml: true
  idleMinutes: 1  # Keep agents alive for 1 minute after job completion
  
  # Use default service account
  useDefaultServiceAccount: true
  
  # Agent connection settings
  kubernetesConnectTimeout: 5
  kubernetesReadTimeout: 15
  maxRequestsPerHostStr: "32"
  retentionTimeout: 5
  waitForPodSec: 600
  
  # Kubernetes cluster connection (fix for Minikube)
  jenkinsUrl: "http://jenkins:8080"
  jenkinsTunnel: "jenkins:50000"
  
  # Agent image
  image:
    registry: ""
    repository: "jenkins/inbound-agent"
    tag: "3309.v27b_9314fd1a_4-6"
  
  workingDir: "/home/jenkins/agent"
  nodeUsageMode: "NORMAL"
  componentName: "jenkins-agent"
  
  # Connection settings
  args: "${computer.jnlpmac} ${computer.name}"
  sideContainerName: "jnlp"
  connectTimeout: 100